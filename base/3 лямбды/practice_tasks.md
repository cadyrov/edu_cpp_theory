# Практические задания: Лямбды C++

## Задание 1: Функциональный калькулятор
**Описание:** Создайте калькулятор используя лямбды для различных математических операций с поддержкой цепочки вычислений.

**Требования:**
- Класс Calculator с методами для базовых операций
- Лямбды для сложных математических функций
- Поддержка цепочки операций
- Обработка ошибок (деление на ноль)
- История операций

**Тесты:**
1. Базовые операции: сложение, вычитание, умножение, деление
2. Обработка деления на ноль с исключением
3. Цепочка операций: Calculator().add(5).multiply(2).subtract(3)
4. Применение лямбды для квадрата числа
5. Применение лямбды для кубического корня
6. История операций - сохранение всех выполненных действий
7. Сложная лямбда для вычисления факториала
8. Функции высшего порядка с лямбдами
9. Захват переменных из внешней области видимости
10. Mutable лямбды для счетчика операций

## Задание 2: Система событий и коллбеков
**Описание:** Реализуйте event-driven систему с использованием лямбд для обработки различных типов событий.

**Требования:**
- Класс EventManager для регистрации и вызова событий
- Разные типы событий (клик, нажатие клавиши, таймер)
- Лямбды как обработчики событий
- Возможность отписки от событий
- Приоритеты обработчиков

**Тесты:**
1. Регистрация простого обработчика события через лямбду
2. Вызов события и выполнение всех зарегистрированных обработчиков
3. Отписка от события по ID
4. Несколько обработчиков для одного события
5. Захват переменных в лямбдах-обработчиках
6. Обработчики с разными приоритетами
7. Условное выполнение обработчиков
8. Обработка исключений в лямбдах-обработчиках
9. Автоматическое удаление обработчиков при уничтожении объектов
10. Event с параметрами разных типов

## Задание 3: Функциональное программирование с контейнерами
**Описание:** Создайте набор функций для функционального программирования с STL контейнерами используя лямбды.

**Требования:**
- Функции map, filter, reduce для любых контейнеров
- Поддержка цепочки вызовов
- Ленивые вычисления где возможно
- Generic подход для разных типов
- Поддержка пользовательских предикатов

**Тесты:**
1. map: преобразование vector<int> в vector<string>
2. filter: фильтрация четных чисел из вектора
3. reduce: вычисление суммы элементов
4. Цепочка операций: filter → map → reduce
5. Работа с vector<string> - фильтрация по длине
6. map с захватом внешних переменных
7. Пользовательские предикаты для сложной фильтрации
8. reduce с пользовательской функцией объединения
9. Работа с пустыми контейнерами
10. Производительность vs std::transform/copy_if

## Задание 4: Асинхронные задачи с лямбдами
**Описание:** Реализуйте простую систему асинхронного выполнения задач используя лямбды и std::future.

**Требования:**
- TaskManager для постановки задач в очередь
- Лямбды как задачи для выполнения
- Поддержка возвращаемых значений
- Обработка исключений в задачах
- Контроль выполнения и отмены задач

**Тесты:**
1. Постановка простой задачи-лямбды в очередь
2. Получение результата асинхронной задачи
3. Обработка исключения в асинхронной задаче
4. Несколько задач выполняются параллельно
5. Задача с захватом переменных по значению
6. Задача с захватом переменных по ссылке
7. Отмена задачи до начала выполнения
8. Ожидание завершения всех задач
9. Задачи с разными типами возвращаемых значений
10. Производительность параллельного vs последовательного выполнения

## Задание 5: Парсер конфигурационных файлов
**Описание:** Создайте парсер конфигурационных файлов с использованием лямбд для обработки различных типов значений.

**Требования:**
- Поддержка разных типов: string, int, double, bool
- Лямбды для валидации значений
- Лямбды для преобразования типов
- Обработка ошибок парсинга
- Возможность добавления кастомных типов

**Тесты:**
1. Парсинг простых key=value пар
2. Валидация значений через лямбды
3. Преобразование строк в числа с обработкой ошибок
4. Парсинг boolean значений (true/false, 1/0, yes/no)
5. Кастомные валидаторы для email, URL
6. Секционированный конфиг файл [section]
7. Комментарии в файле (игнорирование строк с #)
8. Значения в кавычках с escape-последовательностями
9. Массивы значений разделенные запятыми
10. Вложенные конфигурации и наследование

## Задание 6: Система логирования с лямбдами
**Описание:** Реализуйте гибкую систему логирования с настраиваемыми форматтерами и фильтрами на основе лямбд.

**Требования:**
- Разные уровни логирования (DEBUG, INFO, WARN, ERROR)
- Лямбды как форматтеры сообщений
- Лямбды как фильтры сообщений
- Несколько выходных потоков
- Асинхронное логирование

**Тесты:**
1. Базовое логирование с разными уровнями
2. Кастомный форматтер через лямбду
3. Фильтрация сообщений по уровню через лямбду
4. Фильтрация по содержимому сообщения
5. Логирование в несколько файлов одновременно
6. Ротация логов по размеру/времени
7. Асинхронное логирование для производительности
8. Структурированное логирование (JSON формат)
9. Контекстное логирование с метаданными
10. Производительность при высокой нагрузке

## Задание 7: Валидатор данных
**Описание:** Создайте систему валидации данных с композицией правил через лямбды.

**Требования:**
- Базовые правила валидации (длина, диапазон, регекс)
- Композиция правил через логические операторы
- Кастомные правила через лямбды
- Подробные сообщения об ошибках
- Валидация сложных структур данных

**Тесты:**
1. Валидация строки по длине
2. Валидация числа в диапазоне
3. Валидация email через регулярное выражение
4. Композиция правил: AND, OR, NOT
5. Кастомное правило через лямбду
6. Валидация структуры (имя + возраст + email)
7. Сбор всех ошибок валидации
8. Условная валидация (если поле A заполнено, то и B обязательно)
9. Валидация коллекций элементов
10. Производительность валидации больших объемов данных

## Задание 8: Функциональный pipeline обработки данных
**Описание:** Реализуйте pipeline для обработки данных с использованием лямбд и композиции функций.

**Требования:**
- Класс Pipeline для цепочки обработки
- Этапы обработки как лямбды
- Поддержка разных типов данных
- Ошибки обработки и откат
- Параллельная обработка этапов

**Тесты:**
1. Простой pipeline: input → transform → output
2. Pipeline с несколькими этапами трансформации
3. Фильтрация данных на промежуточных этапах
4. Обработка ошибок в pipeline
5. Откат к предыдущему состоянию при ошибке
6. Параллельная обработка независимых этапов
7. Условное выполнение этапов
8. Метрики производительности для каждого этапа
9. Pipeline с разветвлениями
10. Сохранение промежуточных результатов

## Задание 9: Реактивные вычисления
**Описание:** Создайте систему реактивных вычислений где изменения данных автоматически пересчитывают зависимые значения через лямбды.

**Требования:**
- Reactive переменные с подписчиками
- Лямбды как вычисляемые свойства
- Автоматическое отслеживание зависимостей
- Предотвращение циклических зависимостей
- Батчевое обновление для производительности

**Тесты:**
1. Простая reactive переменная с подписчиком
2. Вычисляемое свойство зависящее от reactive переменной
3. Цепочка зависимостей: A → B → C
4. Множественные подписчики на одну переменную
5. Отписка от уведомлений
6. Обнаружение циклических зависимостей
7. Батчевое обновление для избежания лишних пересчетов
8. Условные зависимости
9. Асинхронные вычисления в reactive цепочке
10. Производительность при большом количестве зависимостей

## Задание 10: Дерево решений с лямбдами
**Описание:** Реализуйте гибкое дерево решений где условия и действия представлены лямбдами.

**Требования:**
- Узлы дерева с условиями (лямбды-предикаты)
- Листья дерева с действиями (лямбды-функции)
- Навигация по дереву на основе данных
- Сохранение пути принятия решения
- Динамическое построение дерева

**Тесты:**
1. Простое дерево решений с двумя ветками
2. Многоуровневое дерево с несколькими условиями
3. Дерево для классификации объектов
4. Сохранение пути принятия решения
5. Дерево с действиями разных типов
6. Динамическое добавление новых веток
7. Валидация дерева (все пути ведут к листьям)
8. Оптимизация дерева (удаление неиспользуемых веток)
9. Сериализация и десериализация дерева
10. Производительность навигации в больших деревьях

---

## Критерии оценки

**Отлично (5):**
- Все тесты проходят
- Эффективное использование лямбд
- Правильное управление захватом переменных
- Обработка исключений
- Читаемый и поддерживаемый код

**Хорошо (4):**
- 8-9 тестов проходят
- Корректное использование лямбд
- Небольшие недочеты в захвате переменных
- Базовая обработка ошибок

**Удовлетворительно (3):**
- 6-7 тестов проходят
- Основная функциональность работает
- Неоптимальное использование лямбд
- Минимальная обработка ошибок

**Неудовлетворительно (2):**
- Менее 6 тестов проходят
- Серьезные ошибки в использовании лямбд
- Проблемы с захватом переменных
- Отсутствие обработки ошибок

## Полезные советы

### Захват переменных:
- `[=]` - захват по значению (копирование)
- `[&]` - захват по ссылке
- `[var]` - захват конкретной переменной по значению
- `[&var]` - захват конкретной переменной по ссылке
- `[=, &var]` - все по значению, кроме var по ссылке

### Мutable лямбды:
```cpp
auto counter = [count = 0]() mutable { return ++count; };
```

### Указание типа возврата:
```cpp
auto lambda = [](int x) -> double { return x / 2.0; };
```

### Generic лямбды (C++14):
```cpp
auto generic = [](auto x, auto y) { return x + y; };
``` 